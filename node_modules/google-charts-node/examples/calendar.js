const fs = require('fs');

const GoogleChartsNode = require('../index');

(async () => {
  const image = await GoogleChartsNode.render(drawChart, {
    packages: ['calendar'],
    width: 960,
    height: 350,
  });

  fs.writeFileSync('/tmp/google-chart.png', image);
})();

function drawChart() {
  var dataTable = new google.visualization.DataTable();
  dataTable.addColumn({ type: 'date', id: 'Date' });
  dataTable.addColumn({ type: 'number', id: 'Attendance' });

  dataTable.addRows([
    [new Date(2012, 3, 13), 37032],
    [new Date(2012, 3, 14), 38024],
    [new Date(2012, 3, 15), 38024],
    [new Date(2012, 3, 16), 38108],
    [new Date(2012, 3, 17), 38229],
    [new Date(2012, 3, 18), 37967],
    [new Date(2012, 3, 20), 36770],
    [new Date(2012, 3, 21), 37839],
    [new Date(2012, 3, 30), 37359],
    [new Date(2012, 4, 1), 37225],
    [new Date(2012, 4, 2), 37434],
    [new Date(2012, 4, 4), 37223],
    [new Date(2012, 4, 5), 37581],
    [new Date(2012, 4, 6), 37394],
    [new Date(2012, 4, 10), 37348],
    [new Date(2012, 4, 11), 37438],
    [new Date(2012, 4, 12), 38048],
    [new Date(2012, 4, 13), 37611],
    [new Date(2012, 4, 14), 37334],
    [new Date(2012, 4, 15), 37292],
    [new Date(2012, 4, 25), 37594],
    [new Date(2012, 4, 26), 38099],
    [new Date(2012, 4, 27), 37844],
    [new Date(2012, 4, 28), 37921],
    [new Date(2012, 4, 29), 37216],
    [new Date(2012, 4, 30), 37195],
    [new Date(2012, 4, 31), 37629],
    [new Date(2012, 5, 5), 37181],
    [new Date(2012, 5, 6), 37243],
    [new Date(2012, 5, 7), 37307],
    [new Date(2012, 5, 8), 37309],
    [new Date(2012, 5, 9), 37534],
    [new Date(2012, 5, 10), 37467],
    [new Date(2012, 5, 19), 37701],
    [new Date(2012, 5, 20), 37362],
    [new Date(2012, 5, 21), 37261],
    [new Date(2012, 5, 22), 37281],
    [new Date(2012, 5, 23), 37782],
    [new Date(2012, 5, 24), 37565],
    [new Date(2012, 5, 25), 37208],
    [new Date(2012, 5, 26), 37755],
    [new Date(2012, 5, 27), 37744],
    [new Date(2012, 6, 6), 38066],
    [new Date(2012, 6, 8), 38270],
    [new Date(2012, 6, 16), 38334],
    [new Date(2012, 6, 17), 37771],
    [new Date(2012, 6, 18), 37367],
    [new Date(2012, 6, 19), 38413],
    [new Date(2012, 6, 20), 38093],
    [new Date(2012, 6, 21), 38170],
    [new Date(2012, 6, 22), 37737],
    [new Date(2012, 6, 30), 37784],
    [new Date(2012, 6, 31), 37275],
    [new Date(2012, 7, 1), 37213],
    [new Date(2012, 7, 2), 37191],
    [new Date(2012, 7, 3), 37285],
    [new Date(2012, 7, 4), 37914],
    [new Date(2012, 7, 5), 37019],
    [new Date(2012, 7, 6), 37316],
    [new Date(2012, 7, 7), 38416],
    [new Date(2012, 7, 8), 37716],
    [new Date(2012, 7, 21), 37794],
    [new Date(2012, 7, 22), 37373],
    [new Date(2012, 7, 23), 37829],
    [new Date(2012, 7, 24), 37228],
    [new Date(2012, 7, 25), 37103],
    [new Date(2012, 7, 26), 37188],
    [new Date(2012, 7, 27), 37506],
    [new Date(2012, 8, 7), 37156],
    [new Date(2012, 8, 8), 37107],
    [new Date(2012, 8, 9), 37226],
    [new Date(2012, 8, 11), 37437],
    [new Date(2012, 8, 12), 37230],
    [new Date(2012, 8, 13), 38134],
    [new Date(2012, 8, 21), 37731],
    [new Date(2012, 8, 22), 37570],
    [new Date(2012, 8, 23), 37310],
    [new Date(2012, 8, 25), 37045],
    [new Date(2012, 8, 26), 37247],
    [new Date(2013, 3, 8), 37008],
    [new Date(2013, 3, 10), 30862],
    [new Date(2013, 3, 11), 27704],
    [new Date(2013, 3, 13), 33039],
    [new Date(2013, 3, 14), 35198],
    [new Date(2013, 3, 15), 37449],
    [new Date(2013, 3, 20), 35152],
    [new Date(2013, 3, 22), 28926],
    [new Date(2013, 3, 23), 29006],
    [new Date(2013, 3, 24), 29274],
    [new Date(2013, 3, 25), 30093],
    [new Date(2013, 3, 26), 29312],
    [new Date(2013, 3, 27), 34726],
    [new Date(2013, 3, 28), 36527],
    [new Date(2013, 4, 6), 31088],
    [new Date(2013, 4, 7), 30549],
    [new Date(2013, 4, 8), 29969],
    [new Date(2013, 4, 9), 31571],
    [new Date(2013, 4, 10), 33606],
    [new Date(2013, 4, 11), 36543],
    [new Date(2013, 4, 12), 35532],
    [new Date(2013, 4, 23), 35254],
    [new Date(2013, 4, 24), 34074],
    [new Date(2013, 4, 25), 36504],
    [new Date(2013, 4, 26), 37046],
    [new Date(2013, 4, 27), 33627],
    [new Date(2013, 4, 28), 33463],
    [new Date(2013, 5, 4), 32035],
    [new Date(2013, 5, 5), 33296],
    [new Date(2013, 5, 6), 35352],
    [new Date(2013, 5, 9), 37054],
    [new Date(2013, 5, 19), 35710],
    [new Date(2013, 5, 25), 36286],
    [new Date(2013, 5, 26), 34632],
    [new Date(2013, 5, 27), 34750],
    [new Date(2013, 5, 28), 36383],
    [new Date(2013, 5, 29), 37437],
    [new Date(2013, 5, 30), 37425],
    [new Date(2013, 6, 2), 36498],
    [new Date(2013, 6, 3), 36911],
    [new Date(2013, 6, 4), 37607],
    [new Date(2013, 6, 19), 38130],
    [new Date(2013, 6, 20), 37601],
    [new Date(2013, 6, 21), 38138],
    [new Date(2013, 6, 22), 35016],
    [new Date(2013, 6, 23), 34609],
    [new Date(2013, 6, 24), 36514],
    [new Date(2013, 6, 29), 37242],
    [new Date(2013, 6, 30), 34578],
    [new Date(2013, 6, 31), 35059],
    [new Date(2013, 7, 1), 35886],
    [new Date(2013, 7, 2), 37652],
    [new Date(2013, 7, 3), 37941],
    [new Date(2013, 7, 4), 37611],
    [new Date(2013, 7, 16), 38143],
    [new Date(2013, 7, 17), 37517],
    [new Date(2013, 7, 18), 37917],
    [new Date(2013, 7, 27), 36226],
    [new Date(2013, 7, 28), 31962],
    [new Date(2013, 7, 29), 33300],
    [new Date(2013, 7, 30), 36063],
    [new Date(2013, 7, 31), 37363],
    [new Date(2013, 8, 1), 37053],
    [new Date(2013, 8, 2), 36188],
    [new Date(2013, 8, 3), 32071],
    [new Date(2013, 8, 4), 33720],
    [new Date(2013, 8, 13), 37542],
    [new Date(2013, 8, 14), 37510],
    [new Date(2013, 8, 15), 37137],
    [new Date(2013, 8, 17), 35030],
    [new Date(2013, 8, 18), 38540],
    [new Date(2013, 8, 19), 36436],
    [new Date(2013, 8, 20), 37215],
    [new Date(2013, 8, 21), 37569],
    [new Date(2013, 8, 22), 37020],
    [new Date(2013, 9, 4), 38177],
    [new Date(2013, 9, 5), 38705],
    [new Date(2013, 9, 12), 38210],
    [new Date(2013, 9, 13), 38029],
    [new Date(2013, 9, 19), 38823],
    [new Date(2013, 9, 23), 38345],
    [new Date(2013, 9, 24), 38436],
    [new Date(2013, 9, 30), 38447],
  ]);

  var chart = new google.visualization.Calendar(container);

  var options = {
    title: 'Red Sox Attendance',
    height: 350,
    calendar: {
      monthLabel: {
        fontName: 'Times-Roman',
        fontSize: 12,
        color: '#981b48',
        bold: true,
        italic: true,
      },
      monthOutlineColor: {
        stroke: '#981b48',
        strokeOpacity: 0.8,
        strokeWidth: 2,
      },
      unusedMonthOutlineColor: {
        stroke: '#bc5679',
        strokeOpacity: 0.8,
        strokeWidth: 1,
      },
      underMonthSpace: 16,
    },
  };
  chart.draw(dataTable, options);
}
